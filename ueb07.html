<!DOCTYPE html>
<html>
<head>
    <title>Welcome to WebGL</title>

    <link rel="stylesheet" href="../css/webglbook.css" />
    <script src="three.min.js"></script>
    <script src="RequestAnimationFrame.js"></script>
    <script>

        var renderer = null,
            scene = null,
            camera = null,
            cube = null,
            animating = false,
            yrot = false;

        function onLoad()
        {
            // Grab our container div
            var container = document.getElementById("container");

            // Create the Three.js renderer, add it to our div
            renderer = new THREE.WebGLRenderer( { antialias: true } );
            renderer.setSize(container.offsetWidth, container.offsetHeight);
            container.appendChild( renderer.domElement );

            // Create a new Three.js scene
            scene = new THREE.Scene();

            // Put in a camera
            camera = new THREE.PerspectiveCamera( 45, container.offsetWidth / container.offsetHeight, 1, 4000 );
            camera.position.set( 0, 0, 5 );

            // Create a directional light to show off the object
            var light = new THREE.DirectionalLight( 0xffffff, 1.5);
            light.position.set(0, 0, 1);
            scene.add( light );

            // Create a colored cube and add it to the scene

            // First, create a MeshFaceMaterial for coloring each face
            var mats = [];
            mats.push(new THREE.MeshBasicMaterial({ color: 0x009e60  }));
            mats.push(new THREE.MeshBasicMaterial({ color: 0x0051ba  }));
            mats.push(new THREE.MeshBasicMaterial({ color: 0xffd500  }));
            mats.push(new THREE.MeshBasicMaterial({ color: 0xff5800  }));
            mats.push(new THREE.MeshBasicMaterial({ color: 0xC41E3A }));
            mats.push(new THREE.MeshBasicMaterial({ color: 0xffffff  }));
            var faceMaterial = new THREE.MeshFaceMaterial(mats);


            // Create the cube geometry by hand

            var geometry = new THREE.Geometry();

            //Gesamth√∂he: height * m
            var h = 3;
            var radius = 1;
            var n = 16;
            var m = 4;
            var height = h*m;

            //J
            geometry.vertices.push(new THREE.Vector3(0,0,0));

            var oberseite = [];
            var unterseite = [];

            for (var i = 1; i <= n; i++) {
                var theta = (i / n) * Math.PI * 2;
                oberseite.push([Math.cos(theta) * radius, Math.sin(theta) * radius, 0]);
                unterseite.push([height + Math.cos(theta) * radius, height + Math.sin(theta) * radius, 0]);
                geometry.vertices.push(new THREE.Vector3(Math.cos(theta) * radius, Math.sin(theta) * radius, 0))
            }

            for (var i = 0; i < oberseite.length; i++) {
                geometry.faces.push(new THREE.Face3(0,i,i+1,null,null,0));
                if (i == oberseite.length-1) {
                    geometry.faces.push(new THREE.Face3(0,i+1,1,null,null,0));
                }
            }

            //A
            geometry.vertices.push(new THREE.Vector3(0,height,0));
            for (var i = 0; i < unterseite.length; i++) {
                geometry.faces.push(new THREE.Face3(0,i,i+1,null,null,0));
                if (i == oberseite.length-1) {
                    geometry.faces.push(new THREE.Face3(0,i+1,1,null,null,0));
                }
            }

            // And put the geometry and material together into a mesh
            cube = new THREE.Mesh(geometry,faceMaterial);
            var sphereAxis = new THREE.AxesHelper(20);
            cube.add(sphereAxis);

            // Turn it toward the scene, or we won't see the cube shape!
            cube.rotation.x = Math.PI / 5;
            cube.rotation.y = Math.PI / 5;


            // Add the cube to our scene
            scene.add( cube );

            // Add a mouse up handler to toggle the animation
            addMouseHandler();

            // Run our render loop
            run();
        }

        function run()
        {
            // Render the scene
            renderer.render( scene, camera );

            // Spin the cube for next frame
            if (animating)
            {
                if (yrot) cube.rotation.y -= 0.01; else cube.rotation.x -= 0.01;
            }

            // Ask for another frame
            requestAnimationFrame(run);
        }

        function addMouseHandler()
        {
            var dom = renderer.domElement;

            dom.addEventListener( 'mouseup', onMouseUp, false);
        }

        function onMouseUp	(event)
        {
            event.preventDefault();

            animating = !animating;

            if (animating) yrot = !yrot;
        }

    </script>

</head>
<body onLoad="onLoad();" style="">
<center><h1>Simon Trumm (120099)</h1></center>
<div id="container" style="width:95%; height:80%; position:absolute;"></div>
<div id="prompt" style="width:95%; height:6%; bottom:0; text-align:center; position:absolute;">Click to animate the cube</div>

</body>
</html>
